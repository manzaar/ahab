<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ahab</title>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&display=swap" rel="stylesheet">
  <style>
    @keyframes yumPop {
      0% { opacity: 0; transform: scale(0.5); }
      20% { opacity: 1; transform: scale(1.1); }
      40% { transform: scale(1); }
      100% { opacity: 0; transform: scale(1.2) translateY(-30px); }
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }
    @keyframes glow {
      0%, 100% { box-shadow: 0 0 20px rgba(220, 38, 38, 0.3); }
      50% { box-shadow: 0 0 40px rgba(220, 38, 38, 0.5); }
    }
    @keyframes shrink {
      from { width: 100%; }
      to { width: 0%; }
    }
    @keyframes glitch {
      0%, 90%, 100% { transform: translate(0); opacity: 1; }
      92% { transform: translate(-2px, 1px); opacity: 0.8; }
      94% { transform: translate(2px, -1px); opacity: 0.9; }
      96% { transform: translate(-1px, 2px); opacity: 0.7; }
      98% { transform: translate(1px, -2px); opacity: 1; }
    }
    @keyframes liquidWave {
      0%, 100% { transform: translateX(-2px) skewX(-1deg); }
      50% { transform: translateX(2px) skewX(1deg); }
    }
    @keyframes reactorPulse {
      0% { box-shadow: 0 0 5px rgba(239, 68, 68, 0.5); }
      50% { box-shadow: 0 0 20px rgba(239, 68, 68, 0.8), 0 0 30px rgba(239, 68, 68, 0.4); }
      100% { box-shadow: 0 0 5px rgba(239, 68, 68, 0.5); }
    }
    .animate-fade-in { animation: fadeIn 0.4s ease-out forwards; }
    .glow { animation: glow 2s infinite; }
    .glitch-text { animation: glitch 3s infinite; }
    .reactor-engaged { animation: reactorPulse 1.5s infinite; }
    .liquid-bar { animation: liquidWave 2s ease-in-out infinite; }
  </style>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">
    const { useState, useEffect } = React;

    const AhabApp = () => {
      const [currentView, setCurrentView] = useState('home');
      const [weekData, setWeekData] = useState({});
      const [currentWeight, setCurrentWeight] = useState('233');
      const [groceryChecked, setGroceryChecked] = useState({});
      const [workoutLog, setWorkoutLog] = useState({});
      const [selectedWorkout, setSelectedWorkout] = useState('push');
      const [quoteIndex, setQuoteIndex] = useState(0);
      const [quoteFade, setQuoteFade] = useState(true);
      const [workoutDate, setWorkoutDate] = useState(new Date().toISOString().split('T')[0]);
      const [videos, setVideos] = useState([]);
      const [newVideoUrl, setNewVideoUrl] = useState('');
      const [activeVideo, setActiveVideo] = useState(null);
      const [videoCategory, setVideoCategory] = useState('all');
      const [timerSeconds, setTimerSeconds] = useState(90);
      const [timerRunning, setTimerRunning] = useState(false);
      const [timerMode, setTimerMode] = useState('rest');
      const [showYum, setShowYum] = useState(false);
      const [showLogged, setShowLogged] = useState(false);
      const [dayComplete, setDayComplete] = useState(false);
      const [currentTime, setCurrentTime] = useState(new Date());
      const [calendarMonth, setCalendarMonth] = useState(new Date());
      const [calendarDayDetail, setCalendarDayDetail] = useState(null);
      const [longPressTimer, setLongPressTimer] = useState(null);
      const [xp, setXp] = useState(0);

      // Reactor Switch Component
      const ReactorSwitch = ({ engaged, onToggle, label, color = 'red' }) => {
        const colors = {
          red: { bg: 'from-red-900 to-red-700', text: 'text-red-400' },
          orange: { bg: 'from-orange-900 to-orange-700', text: 'text-orange-400' },
          blue: { bg: 'from-blue-900 to-blue-700', text: 'text-blue-400' }
        };
        const c = colors[color];
        return (
          <button onClick={onToggle} className={`relative w-full h-12 rounded-xl overflow-hidden transition-all duration-300 ${engaged ? `bg-gradient-to-r ${c.bg}` : 'bg-neutral-900 border border-neutral-800'}`}>
            <div className={`absolute inset-0 flex items-center justify-between px-4`}>
              <span className={`text-xs font-bold uppercase tracking-wider ${engaged ? 'text-white' : c.text}`}>{label}</span>
              <div className={`w-14 h-7 rounded-full ${engaged ? 'bg-black/30' : 'bg-neutral-800'} flex items-center p-1 transition-all`}>
                <div className={`w-5 h-5 rounded-full transition-all duration-300 ${engaged ? 'bg-white ml-auto' : 'bg-neutral-600'}`} />
              </div>
            </div>
          </button>
        );
      };
      const [personalRecords, setPersonalRecords] = useState({
        bench: { weight: '', reps: '', date: '' },
        squat: { weight: '', reps: '', date: '' },
        deadlift: { weight: '', reps: '', date: '' },
        ohp: { weight: '', reps: '', date: '' },
        pullups: { weight: '', reps: '', date: '' }
      });

      const prNames = {
        bench: 'BENCH PRESS',
        squat: 'SQUAT',
        deadlift: 'DEADLIFT',
        ohp: 'OVERHEAD PRESS',
        pullups: 'PULL-UPS'
      };

      const ranks = [
        { level: 10, name: 'HOLLOW', icon: 'üíÄ', xpRequired: 0 },
        { level: 9, name: 'REVENANT', icon: '‚öîÔ∏è', xpRequired: 100 },
        { level: 8, name: 'SLAYER', icon: 'üõ°Ô∏è', xpRequired: 200 },
        { level: 7, name: 'OVERLORD', icon: 'üëπ', xpRequired: 300 },
        { level: 6, name: 'APEX', icon: '‚ö°', xpRequired: 400 },
        { level: 5, name: 'MYTHIC', icon: 'üîÆ', xpRequired: 500 },
        { level: 4, name: 'EXALTED', icon: 'üëë', xpRequired: 600 },
        { level: 3, name: 'DEMIGOD', icon: 'üåü', xpRequired: 700 },
        { level: 2, name: 'ASCENDANT', icon: '‚ú®', xpRequired: 800 },
        { level: 1, name: 'APOTHEOSIS', icon: 'üèÜ', xpRequired: 900 }
      ];

      const getCurrentRank = () => {
        for (let i = ranks.length - 1; i >= 0; i--) {
          if (xp >= ranks[i].xpRequired) return ranks[i];
        }
        return ranks[0];
      };

      const getNextRank = () => {
        const current = getCurrentRank();
        const idx = ranks.findIndex(r => r.level === current.level);
        return idx < ranks.length - 1 ? ranks[idx + 1] : null;
      };

      const getXpProgress = () => {
        const current = getCurrentRank();
        const next = getNextRank();
        if (!next) return 100;
        const xpIntoLevel = xp - current.xpRequired;
        const xpNeeded = next.xpRequired - current.xpRequired;
        return (xpIntoLevel / xpNeeded) * 100;
      };

      const logProgress = () => {
        localStorage.setItem('weekData', JSON.stringify(weekData));
        localStorage.setItem('currentWeight', currentWeight);
        localStorage.setItem('grocery', JSON.stringify(groceryChecked));
        localStorage.setItem('workouts', JSON.stringify(workoutLog));

        // Award XP: 10 per meal, 20 for training, 5 for water (8 glasses)
        const td = weekData[getTodayString()] || {};
        const todayKey = `xp_awarded_${getTodayString()}`;
        if (!localStorage.getItem(todayKey)) {
          let earnedXp = 0;
          if (td.meal1) earnedXp += 10;
          if (td.meal2) earnedXp += 10;
          if (td.meal3) earnedXp += 10;
          if (td.training) earnedXp += 20;
          if ((td.water || 0) >= 8) earnedXp += 5;
          if (earnedXp > 0) {
            const newXp = xp + earnedXp;
            setXp(newXp);
            localStorage.setItem('xp', newXp.toString());
            localStorage.setItem(todayKey, 'true');
          }
        }

        setShowLogged(true);
        setTimeout(() => setShowLogged(false), 1500);
        // If all tasks done, mark day as complete to hide the bar
        if (td.meal1 && td.meal2 && td.meal3 && td.training) {
          setDayComplete(true);
        }
      };

      const defaultVideos = [
        { id: 'eC7xzavzEKY', title: 'Why Life Seems to Speed Up as We Age', category: 'philosophy' },
        { id: 'WPPPFqsECz0', title: 'The philosophy of Stoicism', category: 'philosophy' },
        { id: 'w8-k_EJW5bY', title: 'Why Socrates Hated Democracy', category: 'philosophy' },
        { id: '5sD_2jNl5b4', title: 'The Absurd Philosophy of Albert Camus', category: 'philosophy' },
        { id: 'D7CH9cRN8Rg', title: 'What Is Existentialism?', category: 'philosophy' },
        { id: 'rE3j_RHkqJc', title: 'The Psychology of Self-Deception', category: 'psychology' },
        { id: 'wfYbgdo8e-8', title: 'Carl Jung - How to Realize Your True Potential', category: 'psychology' },
        { id: 'n3Xv_g3g-mA', title: 'Dopamine Detox: Why You Should Do It', category: 'psychology' },
        { id: 'LO1mTELoj6o', title: 'Why You Procrastinate Even When It Feels Bad', category: 'psychology' },
        { id: 'EbBHk_zLTmY', title: 'History of the Entire World', category: 'history' },
        { id: 'xuCn8ux2gbs', title: 'History of Japan', category: 'history' },
        { id: '9BugznGj6bU', title: 'The Fall of Rome Explained', category: 'history' },
        { id: 'EY6q5dv_B-o', title: 'Genghis Khan - Rise of the Mongol Empire', category: 'history' },
      ];

      const triggerYum = () => { setShowYum(true); setTimeout(() => setShowYum(false), 1000); };

      const days = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'];

      const animeQuotes = [
        { quote: "I am the hope of the universe. I am the answer to all living things that cry out for peace!", char: "Goku" },
        { quote: "Give up on your dreams and die.", char: "Levi Ackerman" },
        { quote: "If you don't take risks, you can't create a future.", char: "Monkey D. Luffy" },
        { quote: "Push through the pain. Giving up hurts more.", char: "Vegeta" },
        { quote: "The only thing we're allowed to do is believe that we won't regret the choice we made.", char: "Levi" },
        { quote: "A lesson without pain is meaningless.", char: "Edward Elric" },
        { quote: "Hardships make us stronger.", char: "Natsu Dragneel" },
        { quote: "Believe in the me that believes in you!", char: "Kamina" },
        { quote: "The moment you give up is the moment you let someone else win.", char: "Kino" },
        { quote: "Strength is the only thing that matters in this world.", char: "Baki Hanma" },
        { quote: "A dropout will beat a genius through hard work.", char: "Rock Lee" },
        { quote: "Surpass your limits. Right here, right now.", char: "Yami Sukehiro" },
        { quote: "The world isn't perfect. But it's there for us, doing the best it can.", char: "Roy Mustang" },
        { quote: "Fear is not evil. It tells you what your weakness is.", char: "Gildarts" },
        { quote: "Being weak is nothing to be ashamed of. Staying weak is.", char: "Fuegoleon" },
        { quote: "A real man never dies, even when he's killed!", char: "Kamina" },
        { quote: "Power comes in response to a need, not a desire.", char: "Goku" },
        { quote: "It's not about whether I can. I have to do it.", char: "Mikasa Ackerman" },
        { quote: "The ticket to the future is always open.", char: "Vash the Stampede" },
        { quote: "I'll leave tomorrow's problems to tomorrow's me.", char: "Saitama" },
        { quote: "If you don't like your destiny, don't accept it.", char: "Naruto Uzumaki" },
        { quote: "A person grows when they are able to overcome hardships.", char: "Reigen Arataka" },
        { quote: "When you lose, you die. When you win, you live.", char: "Eren Yeager" },
        { quote: "The moment you think of giving up, remember why you held on for so long.", char: "Natsu Dragneel" },
        { quote: "I don't want to conquer anything. I just think that the guy with the most freedom is the Pirate King.", char: "Luffy" },
        { quote: "Whatever you lose, you'll find it again. But what you throw away you'll never get back.", char: "Kenshin Himura" },
        { quote: "Stand up and walk. Keep moving forward.", char: "Edward Elric" },
        { quote: "There's no shame in falling down. True shame is not standing up again.", char: "Shintaro Midorima" },
        { quote: "Life is not a game of luck. If you wanna win, work hard.", char: "Sora" },
        { quote: "You should never give up on life, no matter how you feel.", char: "Canaan" },
        { quote: "Even if we forget the faces of our friends, we'll never forget the bonds.", char: "Otonashi" },
        { quote: "Don't beg for things. Do it yourself, or else you won't get anything.", char: "Renton Thurston" },
        { quote: "No one knows what the future holds. That's why its potential is infinite.", char: "Okabe Rintaro" },
        { quote: "Vision without action is a daydream. Action without vision is a nightmare.", char: "Japanese Proverb" },
        { quote: "People's lives don't end when they die. It ends when they lose faith.", char: "Itachi Uchiha" },
        { quote: "Those who stand at the top determine what's wrong and what's right.", char: "Sosuke Aizen" },
        { quote: "An excellent leader must be passionate because it's their duty to keep everyone moving forward.", char: "Nico Robin" },
        { quote: "To know sorrow is not terrifying. What is terrifying is to know you can't go back.", char: "Matsumoto Rangiku" },
        { quote: "Every journey begins with a single step.", char: "Monkey D. Dragon" },
        { quote: "The only ones who should kill are those who are prepared to be killed.", char: "Lelouch vi Britannia" },
        { quote: "If I can meet you again, against the 6 billion to 1 odds, even if you can't move, I'll marry you.", char: "Hideki" },
        { quote: "I refuse to let my fear control me anymore.", char: "Maka Albarn" },
        { quote: "I want to be strong. I don't want to lose anymore.", char: "Ichigo Kurosaki" },
        { quote: "If you can't find a reason to fight, then you shouldn't be fighting.", char: "Akame" },
        { quote: "Revenge is just the path you took to escape your suffering.", char: "Ichigo Kurosaki" },
        { quote: "In our society, letting others find out that you're a nice person is a very risky move.", char: "Hitagi Senjougahara" },
        { quote: "Life comes at a cost. Wouldn't it be arrogant to die before you've repaid that debt?", char: "Yuuko Ichihara" },
        { quote: "The circumstances of one's birth are irrelevant. It is what you do with the gift of life that determines who you are.", char: "Mewtwo" },
        { quote: "We don't have to know what tomorrow holds! That's why we can live for everything we're worth today!", char: "Natsu Dragneel" },
        { quote: "Forgetting is like a wound. The wound may heal, but it has already left a scar.", char: "Monkey D. Luffy" }
      ];

      const currentQuote = animeQuotes[quoteIndex];

      const getTodayString = () => {
        const dayNames = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
        return dayNames[new Date().getDay()];
      };

      useEffect(() => {
        const cycleQuotes = setInterval(() => {
          setQuoteFade(false);
          setTimeout(() => { setQuoteIndex(prev => (prev + 1) % animeQuotes.length); setQuoteFade(true); }, 500);
        }, 15000);
        return () => clearInterval(cycleQuotes);
      }, []);

      useEffect(() => {
        const clockInterval = setInterval(() => setCurrentTime(new Date()), 1000);
        return () => clearInterval(clockInterval);
      }, []);


      // Progressive reward themes based on rank
      const getThemeColors = () => {
        const rank = getCurrentRank();
        if (rank.level <= 3) return { accent: 'from-yellow-500 to-amber-400', text: 'text-yellow-400', name: 'OBSIDIAN GOLD' }; // Demigod+
        if (rank.level <= 5) return { accent: 'from-purple-500 to-pink-500', text: 'text-purple-400', name: 'VOID PURPLE' }; // Mythic+
        if (rank.level <= 7) return { accent: 'from-cyan-500 to-blue-500', text: 'text-cyan-400', name: 'FROST BLUE' }; // Overlord+
        return { accent: 'from-red-600 to-red-500', text: 'text-red-400', name: 'BLOOD RED' }; // Default
      };
      const theme = getThemeColors();

      const meals = [
        { id: 'meal1', name: 'Breakfast', calories: 700, items: ['4 whole eggs', '200g oatmeal', '1 banana', '100g berries'], macros: '42g protein ¬∑ 70g carbs ¬∑ 28g fat' },
        { id: 'meal2', name: 'Lunch', calories: 700, items: ['200g chicken breast', '200g rice', '150g broccoli', '1 tbsp olive oil'], macros: '62g protein ¬∑ 55g carbs ¬∑ 16g fat' },
        { id: 'meal3', name: 'Dinner', calories: 700, items: ['200g beef', '300g sweet potato', '200g vegetables', '200g yogurt'], macros: '96g protein ¬∑ 55g carbs ¬∑ 16g fat' }
      ];

      const groceryBulk = ['Oats (large container)', 'Rice (5-10 lb bag)', 'Sweet potatoes (10 lb)', 'Olive oil', 'Seasonings & spices'];
      const groceryWeekly = ['Eggs (2 dozen)', 'Chicken breast (3 lbs)', 'Beef (3 lbs)', 'Bananas (7-8)', 'Mixed berries (700g)', 'Broccoli (2 lbs)', 'Mixed vegetables (3 lbs)', 'Greek yogurt (1400g)'];

      const workouts = {
        push: { name: 'Push', exercises: ['Bench Press', 'Overhead Press', 'Incline Dumbbell Press', 'Lateral Raises', 'Tricep Pushdowns'] },
        pull: { name: 'Pull', exercises: ['Pull-ups', 'Barbell Rows', 'Face Pulls', 'Bicep Curls', 'Lat Pulldowns'] },
        legs: { name: 'Legs', exercises: ['Squats', 'Romanian Deadlifts', 'Leg Press', 'Leg Curls', 'Calf Raises'] }
      };

      useEffect(() => {
        const saved = localStorage.getItem('weekData');
        if (saved) setWeekData(JSON.parse(saved));
        else {
          const init = {};
          days.forEach(d => { init[d] = { meal1: false, meal2: false, meal3: false, training: false, cardio1: false, cardio2: false, weight: '', water: 0 }; });
          setWeekData(init);
        }
        const w = localStorage.getItem('currentWeight'); if (w) setCurrentWeight(w);
        const g = localStorage.getItem('grocery'); if (g) setGroceryChecked(JSON.parse(g));
        const wl = localStorage.getItem('workouts'); if (wl) setWorkoutLog(JSON.parse(wl));
        const savedXp = localStorage.getItem('xp'); if (savedXp) setXp(parseInt(savedXp));
        const savedPRs = localStorage.getItem('personalRecords'); if (savedPRs) setPersonalRecords(JSON.parse(savedPRs));
        const vids = localStorage.getItem('videos');
        if (vids) { const saved = JSON.parse(vids); const merged = [...defaultVideos]; saved.forEach(v => { if (!merged.find(m => m.id === v.id)) merged.push(v); }); setVideos(merged); }
        else setVideos(defaultVideos);
      }, []);

      const toggleMeal = (day, meal) => {
        const newData = { ...weekData, [day]: { ...weekData[day], [meal]: !weekData[day][meal] } };
        setWeekData(newData); localStorage.setItem('weekData', JSON.stringify(newData));
        // Reset dayComplete if unchecking on today
        if (day === getTodayString()) setDayComplete(false);
      };

      const updateWeight = (day, wt) => {
        const newData = { ...weekData, [day]: { ...weekData[day], weight: wt } };
        setWeekData(newData); localStorage.setItem('weekData', JSON.stringify(newData));
        if (wt) { setCurrentWeight(wt); localStorage.setItem('currentWeight', wt); }
      };

      const updateWater = (day, amt) => {
        const newData = { ...weekData, [day]: { ...weekData[day], water: amt } };
        setWeekData(newData); localStorage.setItem('weekData', JSON.stringify(newData));
      };

      const toggleGrocery = (item) => {
        const newChecked = { ...groceryChecked, [item]: !groceryChecked[item] };
        setGroceryChecked(newChecked); localStorage.setItem('grocery', JSON.stringify(newChecked));
      };

      const updateExerciseLog = (date, workoutType, exercise, field, value) => {
        const newLog = { ...workoutLog };
        if (!newLog[date]) newLog[date] = {};
        if (!newLog[date][workoutType]) newLog[date][workoutType] = {};
        if (!newLog[date][workoutType][exercise]) newLog[date][workoutType][exercise] = { weight: '', reps: '', sets: '' };
        newLog[date][workoutType][exercise][field] = value;
        setWorkoutLog(newLog); localStorage.setItem('workouts', JSON.stringify(newLog));
      };

      const getExerciseData = (date, workoutType, exercise) => workoutLog[date]?.[workoutType]?.[exercise] || { weight: '', reps: '', sets: '' };

      const updatePR = (lift, field, value) => {
        const newPRs = { ...personalRecords, [lift]: { ...personalRecords[lift], [field]: value } };
        setPersonalRecords(newPRs);
        localStorage.setItem('personalRecords', JSON.stringify(newPRs));
      };

      const getCalendarDays = () => {
        const year = calendarMonth.getFullYear();
        const month = calendarMonth.getMonth();
        const firstDay = new Date(year, month, 1);
        const lastDay = new Date(year, month + 1, 0);
        const daysInMonth = lastDay.getDate();
        const startPadding = firstDay.getDay();
        const days = [];

        for (let i = 0; i < startPadding; i++) days.push(null);
        for (let i = 1; i <= daysInMonth; i++) days.push(i);
        return days;
      };

      const getDayStatus = (day) => {
        if (!day) return 'empty';
        const year = calendarMonth.getFullYear();
        const month = calendarMonth.getMonth();
        const dateObj = new Date(year, month, day);
        const today = new Date();
        today.setHours(0,0,0,0);

        if (dateObj > today) return 'future';

        const dayNames = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
        const dayName = dayNames[dateObj.getDay()];
        const data = weekData[dayName] || {};

        const meals = (data.meal1 ? 1 : 0) + (data.meal2 ? 1 : 0) + (data.meal3 ? 1 : 0);
        const training = data.training ? 1 : 0;

        if (meals === 3 && training === 1) return 'perfect';
        if (meals > 0 || training > 0) return 'partial';
        return 'missed';
      };

      const getWorkoutHistory = (workoutType, exercise) => {
        const history = [];
        Object.keys(workoutLog).sort().reverse().forEach(date => {
          if (workoutLog[date]?.[workoutType]?.[exercise]) {
            const data = workoutLog[date][workoutType][exercise];
            if (data.weight || data.reps || data.sets) history.push({ date, ...data });
          }
        });
        return history.slice(0, 5);
      };

      const filteredVideos = videoCategory === 'all' ? videos : videos.filter(v => v.category === videoCategory);

      useEffect(() => {
        let interval;
        if (timerRunning && timerSeconds > 0) interval = setInterval(() => setTimerSeconds(s => s - 1), 1000);
        else if (timerSeconds === 0) { setTimerRunning(false); try { new Audio('data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdH2Onp+dnZygo6esnZGJgoiTpLrK0M/GurCsq7C5x9PZ2NDCsJ+Uk5Wgr8HS3+DYyru0tbvG1eHo5t3OvrCpqKyzvczc5Obi2My/tK+usMHR4Ojp4dXJvrSur7fE1eDn6OHWyL2zrrC4x9Xg5+fi2cvAtrGxtMDS3+fp5drNwba0trnH1uDo6eTdz8O5tbW4wtTg6Orl4dPIvrm3usPV4ejr5+LWzMK8urrD1+Hq7ejk2tDGwLy8wcnZ4+vs6OXc08nDwL/Ey9rk7O3p5t3Vy8fExMjO2+Tu7uro4NjQy8jHyc/d5e7v7Orn4drTzsvKzNTf5+/w7uvn4t3X0s/O0Nfh6fDx7+3q5uHc2NTS0dPa4+vy8vDu6+fj39vX1dTW3OTq8vPx7+zp5ODb19XV1tvi6fHz8vDt6ubj39zY1tbY3+Xr8/Ty8O3q5+Tf3NnY19rf5Ovz9PPx7uro5ODd2tnZ2t/l6/P09PH').play(); } catch(e) {} }
        return () => clearInterval(interval);
      }, [timerRunning, timerSeconds]);

      const formatTime = (secs) => `${Math.floor(secs / 60)}:${(secs % 60).toString().padStart(2, '0')}`;
      const timerPresets = { rest: [30, 60, 90, 120, 180], hiit: [20, 30, 45, 60] };

      const getTimeGreeting = () => {
        const hour = new Date().getHours();
        if (hour < 12) return 'GOOD MORNING';
        if (hour < 17) return 'GOOD AFTERNOON';
        if (hour < 21) return 'GOOD EVENING';
        return 'LATE NIGHT GRIND';
      };

      const getWeeklyStats = () => {
        let mealsHit = 0, totalMeals = 0, workoutsHit = 0, waterTotal = 0;
        days.forEach(d => {
          if (weekData[d]) {
            if (weekData[d].meal1) mealsHit++; if (weekData[d].meal2) mealsHit++; if (weekData[d].meal3) mealsHit++;
            totalMeals += 3; if (weekData[d].training) workoutsHit++; waterTotal += weekData[d].water || 0;
          }
        });
        return { mealsHit, workoutsHit, consistency: totalMeals > 0 ? Math.round((mealsHit / totalMeals) * 100) : 0, waterTotal };
      };

      const getLastWeekStats = () => {
        const lastWeek = JSON.parse(localStorage.getItem('lastWeekData') || '{}');
        let mealsHit = 0, workoutsHit = 0;
        days.forEach(d => {
          if (lastWeek[d]) {
            if (lastWeek[d].meal1) mealsHit++;
            if (lastWeek[d].meal2) mealsHit++;
            if (lastWeek[d].meal3) mealsHit++;
            if (lastWeek[d].training) workoutsHit++;
          }
        });
        return { mealsHit, workoutsHit, consistency: Math.round((mealsHit / 21) * 100) };
      };

      const getStreak = () => {
        let streak = 0;
        const dayOrder = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
        const todayIdx = new Date().getDay();
        for (let i = 0; i <= todayIdx; i++) {
          const d = dayOrder[i];
          if (weekData[d] && (weekData[d].meal1 || weekData[d].meal2 || weekData[d].meal3 || weekData[d].training)) streak++;
        }
        return streak;
      };

      const getNextWorkout = () => {
        const rotation = ['push', 'pull', 'legs'];
        const lastWorkouts = [];
        Object.keys(workoutLog).sort().reverse().slice(0, 3).forEach(date => {
          Object.keys(workoutLog[date] || {}).forEach(wType => { if (!lastWorkouts.includes(wType)) lastWorkouts.push(wType); });
        });
        if (lastWorkouts.length === 0) return 'push';
        const lastIdx = rotation.indexOf(lastWorkouts[0]);
        return rotation[(lastIdx + 1) % 3];
      };

      const getYouTubeId = (url) => { const match = url.match(/(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))([^&?]+)/); return match ? match[1] : null; };
      const addVideo = () => {
        const videoId = getYouTubeId(newVideoUrl);
        if (videoId && !videos.find(v => v.id === videoId)) {
          const newVideos = [...videos, { id: videoId, title: 'Custom Video', category: 'custom' }];
          setVideos(newVideos); localStorage.setItem('videos', JSON.stringify(newVideos)); setNewVideoUrl('');
        }
      };
      const removeVideo = (videoId) => { const newVideos = videos.filter(v => v.id !== videoId); setVideos(newVideos); localStorage.setItem('videos', JSON.stringify(newVideos)); if (activeVideo === videoId) setActiveVideo(null); };

      const today = getTodayString();
      const todayData = weekData[today] || {};
      const progress = ((233 - parseFloat(currentWeight)) / 43) * 100;
      const weeklyStats = getWeeklyStats();
      const lastWeekStats = getLastWeekStats();
      const streak = getStreak();
      const nextWorkout = getNextWorkout();
      const lbsLost = Math.max(0, 233 - parseFloat(currentWeight || 233)).toFixed(1);

      const Card = ({ children, className = '', onClick, glow }) => (
        <div onClick={onClick} className={`bg-gradient-to-br from-neutral-900 to-black rounded-2xl p-5 border border-red-900/30 transition-all duration-300 ${onClick ? 'cursor-pointer hover:border-red-700/50 hover:from-neutral-800' : ''} ${glow ? 'glow' : ''} ${className}`}>
          {children}
        </div>
      );

      return (
        <div className="min-h-screen bg-black text-white p-4 pb-4 sm:pb-4">
          <div className="max-w-lg mx-auto">
            {/* Header */}
            <div className="mb-6 text-center">
              <h1 className="text-4xl font-black tracking-wider text-transparent bg-clip-text bg-gradient-to-r from-red-500 to-red-700">AHAB</h1>
              <p className="text-red-600 text-xs font-bold tracking-[0.3em] mt-1">THE HUNT IS ON</p>
            </div>

            {/* Progress Bar */}
            <Card className="mb-5" glow>
              <div className="flex justify-between text-sm mb-2">
                <span className="text-red-400 font-bold uppercase tracking-wide">Progress</span>
                <span className="text-red-500 font-black">{progress.toFixed(1)}%</span>
              </div>
              <div className="w-full bg-red-950/50 rounded-full h-3 overflow-hidden">
                <div className="bg-gradient-to-r from-red-700 via-red-500 to-orange-500 h-3 rounded-full transition-all duration-500" style={{ width: `${Math.min(progress, 100)}%` }} />
              </div>
            </Card>

            {/* Quote - Fixed Height */}
            <div className={`mb-5 px-4 py-3 bg-gradient-to-r from-red-950/30 to-transparent border-l-4 border-red-600 rounded-r-xl transition-opacity duration-500 h-[85px] flex flex-col justify-center overflow-hidden ${quoteFade ? 'opacity-100' : 'opacity-0'}`}>
              <p className="text-red-300 text-sm italic overflow-hidden" style={{display: '-webkit-box', WebkitLineClamp: 2, WebkitBoxOrient: 'vertical'}}>"{currentQuote.quote}"</p>
              <p className="text-red-500 text-xs font-bold mt-1 flex-shrink-0">‚Äî {currentQuote.char}</p>
            </div>

            {/* Navigation - Fixed Bottom on Mobile */}
            <div className="fixed bottom-0 left-0 right-0 bg-black/95 backdrop-blur-sm border-t border-red-900/30 p-2 z-50 sm:relative sm:bg-transparent sm:border-0 sm:p-0 sm:mb-6">
              <div className="max-w-lg mx-auto grid grid-cols-6 gap-1">
                {[
                  { id: 'home', icon: 'üè†', label: 'Home' },
                  { id: 'meals', icon: 'üçΩÔ∏è', label: 'Meals' },
                  { id: 'workouts', icon: 'üí™', label: 'Train' },
                  { id: 'power', icon: 'üèÜ', label: 'PRs' },
                  { id: 'calendar', icon: 'üìÖ', label: 'Cal' },
                  { id: 'grocery', icon: 'üõí', label: 'Shop' }
                ].map(v => (
                  <button key={v.id} onClick={() => setCurrentView(v.id)} className={`flex flex-col items-center py-2 px-1 rounded-lg transition-all duration-200 ${currentView === v.id ? 'bg-red-600/20 text-red-400' : 'text-neutral-500 hover:text-red-400'}`}>
                    <span className="text-lg sm:text-xl">{v.icon}</span>
                    <span className="text-[9px] sm:text-[10px] font-bold uppercase mt-0.5">{v.label}</span>
                  </button>
                ))}
              </div>
            </div>

            {/* Spacer for fixed bottom nav on mobile */}
            <div className="h-20 sm:hidden"></div>

            {/* HOME */}
            {currentView === 'home' && (
              <div className="space-y-4 animate-fade-in">
                {/* Digital Clock */}
                <div className="text-center py-2">
                  <div className="text-6xl font-bold text-red-500 tracking-wider" style={{fontFamily: 'Orbitron, monospace', textShadow: '0 0 20px rgba(239,68,68,0.5), 0 0 40px rgba(239,68,68,0.3)'}}>
                    {currentTime.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit', hour12: true }).replace(' ', '')}
                  </div>
                  {/* Countdown to Sept 1, 2026 - Glitch Effect */}
                  <div className="mt-2">
                    <p className="text-red-600 text-xs font-bold tracking-wider glitch-text" style={{fontFamily: 'Orbitron, monospace'}}>
                      DAYS UNTIL SEPT 1, 2026: <span className="text-red-400 text-lg">{Math.max(0, Math.ceil((new Date('2026-09-01') - currentTime) / (1000 * 60 * 60 * 24)))}</span>
                    </p>
                  </div>
                </div>

                {/* Rank Display */}
                <Card className="bg-gradient-to-br from-red-950/50 to-black border-red-700/30">
                  <div className="flex justify-between items-start mb-3">
                    <div>
                      <p className={`text-xs font-bold tracking-wider ${theme.text}`}>RANK LEVEL {getCurrentRank().level}</p>
                      <h2 className="text-2xl font-black text-white flex items-center gap-2">
                        <span className="text-3xl">{getCurrentRank().icon}</span>
                        {getCurrentRank().name}
                      </h2>
                      <p className="text-[10px] text-neutral-500 mt-1">THEME: {theme.name}</p>
                    </div>
                    <div className="text-right">
                      <div className="flex items-center gap-2">
                        <span className="text-3xl">üî•</span>
                        <span className="text-4xl font-black text-orange-500">{streak}</span>
                      </div>
                      <p className="text-xs text-red-500 font-bold">DAY STREAK</p>
                    </div>
                  </div>
                  {/* XP Progress Bar */}
                  <div>
                    <div className="flex justify-between text-xs mb-1">
                      <span className={`font-bold ${theme.text}`}>{xp} XP</span>
                      {getNextRank() && <span className="text-red-600">NEXT: {getNextRank().name} ({getNextRank().xpRequired} XP)</span>}
                      {!getNextRank() && <span className="text-yellow-500 font-bold">MAX RANK</span>}
                    </div>
                    <div className="w-full bg-red-950/50 rounded-full h-3 overflow-hidden">
                      <div className={`bg-gradient-to-r ${theme.accent} h-3 rounded-full transition-all duration-500`} style={{ width: `${getXpProgress()}%` }} />
                    </div>
                  </div>
                </Card>

                <div className="grid grid-cols-2 gap-3">
                  <Card>
                    <div className="relative">
                      <p className="absolute text-3xl font-black text-neutral-800 opacity-30">{lastWeekStats.workoutsHit}/7</p>
                      <p className="text-3xl font-black text-red-500 relative">{weeklyStats.workoutsHit}/7</p>
                    </div>
                    <p className="text-xs text-red-400/70 font-bold uppercase">WORKOUTS</p>
                  </Card>
                  <Card>
                    <div className="relative">
                      <p className="absolute text-3xl font-black text-neutral-800 opacity-30">{lastWeekStats.mealsHit}/21</p>
                      <p className="text-3xl font-black text-red-500 relative">{weeklyStats.mealsHit}/21</p>
                    </div>
                    <p className="text-xs text-red-400/70 font-bold uppercase">MEALS</p>
                  </Card>
                  <Card>
                    <div className="relative">
                      <p className="absolute text-3xl font-black text-neutral-800 opacity-30">{lastWeekStats.consistency}%</p>
                      <p className="text-3xl font-black text-red-500 relative">{weeklyStats.consistency}%</p>
                    </div>
                    <p className="text-xs text-red-400/70 font-bold uppercase">CONSISTENCY</p>
                  </Card>
                  <Card>
                    <p className="text-3xl font-black text-blue-400">{weeklyStats.waterTotal}</p>
                    <p className="text-xs text-blue-400/70 font-bold uppercase">WATER</p>
                  </Card>
                </div>

                {/* VS Last Week */}
                <Card className="border-purple-900/30">
                  <h3 className="text-sm font-bold text-purple-400 uppercase tracking-wider mb-3">‚öîÔ∏è VS LAST WEEK</h3>
                  <div className="space-y-2">
                    <div className="flex justify-between items-center">
                      <span className="text-xs text-neutral-400">WORKOUTS</span>
                      <div className="flex items-center gap-2">
                        <span className="text-sm font-bold text-white">{weeklyStats.workoutsHit}</span>
                        <span className="text-neutral-600">vs</span>
                        <span className="text-sm text-neutral-500">{lastWeekStats.workoutsHit}</span>
                        {weeklyStats.workoutsHit > lastWeekStats.workoutsHit && <span className="text-green-500 font-bold">‚ñ≤</span>}
                        {weeklyStats.workoutsHit < lastWeekStats.workoutsHit && <span className="text-red-500 font-bold">‚ñº</span>}
                        {weeklyStats.workoutsHit === lastWeekStats.workoutsHit && <span className="text-neutral-600">‚Äî</span>}
                      </div>
                    </div>
                    <div className="flex justify-between items-center">
                      <span className="text-xs text-neutral-400">MEALS</span>
                      <div className="flex items-center gap-2">
                        <span className="text-sm font-bold text-white">{weeklyStats.mealsHit}</span>
                        <span className="text-neutral-600">vs</span>
                        <span className="text-sm text-neutral-500">{lastWeekStats.mealsHit}</span>
                        {weeklyStats.mealsHit > lastWeekStats.mealsHit && <span className="text-green-500 font-bold">‚ñ≤</span>}
                        {weeklyStats.mealsHit < lastWeekStats.mealsHit && <span className="text-red-500 font-bold">‚ñº</span>}
                        {weeklyStats.mealsHit === lastWeekStats.mealsHit && <span className="text-neutral-600">‚Äî</span>}
                      </div>
                    </div>
                    <div className="flex justify-between items-center">
                      <span className="text-xs text-neutral-400">CONSISTENCY</span>
                      <div className="flex items-center gap-2">
                        <span className="text-sm font-bold text-white">{weeklyStats.consistency}%</span>
                        <span className="text-neutral-600">vs</span>
                        <span className="text-sm text-neutral-500">{lastWeekStats.consistency}%</span>
                        {weeklyStats.consistency > lastWeekStats.consistency && <span className="text-green-500 font-bold">‚ñ≤</span>}
                        {weeklyStats.consistency < lastWeekStats.consistency && <span className="text-red-500 font-bold">‚ñº</span>}
                        {weeklyStats.consistency === lastWeekStats.consistency && <span className="text-neutral-600">‚Äî</span>}
                      </div>
                    </div>
                  </div>
                </Card>

                <Card onClick={() => { setSelectedWorkout(nextWorkout); setCurrentView('workouts'); }} className="bg-gradient-to-r from-orange-950/50 to-black border-orange-700/30">
                  <div className="flex justify-between items-center">
                    <div>
                      <p className="text-xs text-orange-500 font-bold tracking-wider">NEXT UP</p>
                      <p className="text-xl font-black text-orange-400">{workouts[nextWorkout].name.toUpperCase()} DAY</p>
                    </div>
                    <span className="text-orange-500 text-2xl">‚Üí</span>
                  </div>
                </Card>

                <Card>
                  <div className="flex justify-between items-center mb-4">
                    <h3 className="text-sm font-bold text-red-500 uppercase tracking-wider">{today}'s Log</h3>
                    <button onClick={logProgress} className="bg-gradient-to-r from-green-600 to-green-500 text-white px-4 py-2 rounded-xl text-xs font-black uppercase tracking-wider shadow-lg shadow-green-900/30 hover:from-green-500 hover:to-green-400 transition-all active:scale-95">
                      LOG IT
                    </button>
                  </div>

                  {/* Weight Input */}
                  <div className="flex items-center gap-3 mb-4">
                    <span className="text-red-400 text-sm font-bold w-20">WEIGHT</span>
                    <input type="number" placeholder="LBS" value={todayData.weight || ''} onChange={(e) => updateWeight(today, e.target.value)} className="flex-1 bg-black border border-red-900/50 rounded-xl px-4 py-2 text-red-400 font-bold placeholder-red-900 focus:outline-none focus:border-red-600 transition-colors" />
                  </div>

                  {/* Meals - Reactor Switches */}
                  <div className="space-y-2 mb-4">
                    <p className="text-red-400 text-xs font-bold uppercase tracking-wider mb-2">FUEL INTAKE</p>
                    <ReactorSwitch engaged={todayData.meal1} onToggle={() => { toggleMeal(today, 'meal1'); if (!todayData.meal1) triggerYum(); }} label="MEAL I: BREAKFAST" color="red" />
                    <ReactorSwitch engaged={todayData.meal2} onToggle={() => { toggleMeal(today, 'meal2'); if (!todayData.meal2) triggerYum(); }} label="MEAL II: LUNCH" color="red" />
                    <ReactorSwitch engaged={todayData.meal3} onToggle={() => { toggleMeal(today, 'meal3'); if (!todayData.meal3) triggerYum(); }} label="MEAL III: DINNER" color="red" />
                  </div>

                  {/* Training - Reactor Switch */}
                  <div className="mb-4">
                    <p className="text-orange-400 text-xs font-bold uppercase tracking-wider mb-2">TRAINING</p>
                    <ReactorSwitch engaged={todayData.training} onToggle={() => toggleMeal(today, 'training')} label="STRENGTH TRAINING" color="orange" />
                  </div>

                  {/* Water */}
                  <div className="mb-4">
                    <p className="text-blue-400 text-xs font-bold uppercase tracking-wider mb-2">HYDRATION ({todayData.water || 0}/8)</p>
                    <div className="flex gap-1">
                      {[1,2,3,4,5,6,7,8].map(n => (
                        <button key={n} onClick={() => updateWater(today, todayData.water === n ? 0 : n)} className={`flex-1 h-8 rounded-lg text-xs font-bold transition-all duration-300 ${(todayData.water || 0) >= n ? 'bg-blue-600 text-white shadow-lg shadow-blue-500/30' : 'bg-neutral-900 text-blue-900 border border-blue-900/30'}`}>{n}</button>
                      ))}
                    </div>
                  </div>
                </Card>

                {/* Weekly Overview */}
                <Card>
                  <h3 className="text-sm font-bold text-red-500 uppercase tracking-wider mb-4">WEEKLY OVERVIEW</h3>
                  <div className="space-y-2">
                    {days.map(day => {
                      const dayData = weekData[day] || {};
                      const isToday = day === today;
                      const mealsCount = (dayData.meal1 ? 1 : 0) + (dayData.meal2 ? 1 : 0) + (dayData.meal3 ? 1 : 0);
                      return (
                        <div key={day} className={`flex items-center gap-3 p-2 rounded-xl transition-all ${isToday ? 'bg-red-950/30 border border-red-700/30' : ''}`}>
                          <span className={`w-12 text-xs font-bold ${isToday ? 'text-red-400' : 'text-red-600'}`}>{day.slice(0, 3).toUpperCase()}</span>
                          <div className="flex gap-1 flex-1">
                            {[dayData.meal1, dayData.meal2, dayData.meal3].map((m, i) => (
                              <div key={i} className={`w-6 h-6 rounded-lg flex items-center justify-center text-xs font-bold ${m ? 'bg-red-600 text-white' : 'bg-neutral-900 border border-red-900/20 text-red-900'}`}>
                                {m ? '‚úì' : i + 1}
                              </div>
                            ))}
                            <div className={`w-6 h-6 rounded-lg flex items-center justify-center text-xs font-bold ${dayData.training ? 'bg-orange-600 text-white' : 'bg-neutral-900 border border-orange-900/20 text-orange-900'}`}>
                              {dayData.training ? '‚úì' : 'G'}
                            </div>
                          </div>
                          <div className="flex gap-1">
                            {[1,2,3,4,5,6,7,8].map(n => (
                              <div key={n} className={`w-2 h-4 rounded-sm ${(dayData.water || 0) >= n ? 'bg-blue-500' : 'bg-neutral-800'}`}></div>
                            ))}
                          </div>
                          {dayData.weight && <span className="text-xs text-red-400 font-bold w-12 text-right">{dayData.weight}</span>}
                        </div>
                      );
                    })}
                  </div>
                </Card>

                <div className="flex justify-between px-2">
                  {[10, 25, 50, 75, 100].map(m => (
                    <div key={m} className="text-center">
                      <div className={`w-11 h-11 rounded-full flex items-center justify-center text-xs font-bold transition-all duration-300 ${progress >= m ? 'bg-red-600 text-white' : 'bg-neutral-900 text-red-900 border border-red-900/30'}`}>
                        {progress >= m ? '‚úì' : `${m}%`}
                      </div>
                    </div>
                  ))}
                </div>
              </div>
            )}

            {/* MEALS */}
            {currentView === 'meals' && (
              <div className="space-y-4 animate-fade-in relative">
                {showYum && (
                  <div className="fixed inset-0 flex items-center justify-center pointer-events-none z-50">
                    <div className="text-5xl font-black text-green-400" style={{animation: 'yumPop 1s ease-out forwards'}}>YUM! üî•</div>
                  </div>
                )}

                <Card className="bg-gradient-to-r from-red-950/50 to-black border-red-700/30">
                  <div className="flex justify-between items-center">
                    <div>
                      <p className="text-xs text-red-500 font-bold tracking-wider">TODAY'S FUEL</p>
                      <p className="text-2xl font-black text-white">
                        {(todayData.meal1 ? 700 : 0) + (todayData.meal2 ? 700 : 0) + (todayData.meal3 ? 700 : 0)}
                        <span className="text-red-600 text-lg"> / 2100 CALS</span>
                      </p>
                    </div>
                    <div className="flex gap-1">
                      {['meal1', 'meal2', 'meal3'].map(m => (
                        <div key={m} className={`w-4 h-4 rounded-full transition-colors duration-300 ${todayData[m] ? 'bg-green-500' : 'bg-red-900/50'}`}></div>
                      ))}
                    </div>
                  </div>
                </Card>

                {meals.map((m, idx) => (
                  <Card key={m.id} className={`transition-all duration-300 ${todayData[m.id] ? 'border-green-700/50 bg-gradient-to-br from-green-950/20 to-black' : ''}`}>
                    <div className="flex justify-between items-start mb-3">
                      <div className="flex items-center gap-3">
                        <button onClick={() => { toggleMeal(today, m.id); if (!todayData[m.id]) triggerYum(); }} className={`w-8 h-8 rounded-xl flex items-center justify-center font-bold transition-all duration-300 ${todayData[m.id] ? 'bg-green-600 text-white' : 'bg-neutral-900 border border-red-900/30 text-red-900'}`}>
                          {todayData[m.id] && '‚úì'}
                        </button>
                        <div>
                          <h3 className="font-black text-white uppercase">{m.name}</h3>
                          <p className="text-xs text-red-500">{idx === 0 ? 'PRE-WORKOUT FUEL' : idx === 1 ? 'RECOVERY MEAL' : 'MUSCLE BUILDER'}</p>
                        </div>
                      </div>
                      <span className="text-red-400 font-black">{m.calories} <span className="text-red-600 text-sm">cals</span></span>
                    </div>
                    <ul className="space-y-1 mb-3">
                      {m.items.map((it, i) => <li key={i} className="text-red-300/80 text-sm flex items-center gap-2"><span className="w-1.5 h-1.5 bg-red-600 rounded-full"></span>{it}</li>)}
                    </ul>
                    <p className="text-xs text-red-500/70">{m.macros}</p>
                  </Card>
                ))}

                <Card>
                  <p className="text-sm font-bold text-red-500 uppercase tracking-wider mb-3">DAILY MACRO TOTALS</p>
                  <div className="grid grid-cols-3 gap-3">
                    <div className="text-center p-3 bg-black rounded-xl border border-red-900/30">
                      <p className="text-xl font-black text-red-400">200g</p>
                      <p className="text-xs text-red-600 font-bold">PROTEIN</p>
                    </div>
                    <div className="text-center p-3 bg-black rounded-xl border border-orange-900/30">
                      <p className="text-xl font-black text-orange-400">180g</p>
                      <p className="text-xs text-orange-600 font-bold">CARBS</p>
                    </div>
                    <div className="text-center p-3 bg-black rounded-xl border border-yellow-900/30">
                      <p className="text-xl font-black text-yellow-400">60g</p>
                      <p className="text-xs text-yellow-600 font-bold">FAT</p>
                    </div>
                  </div>
                </Card>
              </div>
            )}

            {/* WORKOUTS */}
            {currentView === 'workouts' && (
              <div className="space-y-4 animate-fade-in">
                {/* Sub-navigation: Push/Pull/Legs (Angular style) */}
                <div className="flex gap-1 mb-2 bg-neutral-900/50 p-1 rounded-lg">
                  {Object.keys(workouts).map(w => (
                    <button key={w} onClick={() => setSelectedWorkout(w)} className={`flex-1 py-2 rounded-md text-xs font-bold uppercase tracking-wider transition-all duration-200 ${selectedWorkout === w ? 'bg-red-700 text-white' : 'text-red-500/70 hover:text-red-400 hover:bg-neutral-800/50'}`}>{workouts[w].name}</button>
                  ))}
                </div>
                <input type="date" value={workoutDate} onChange={(e) => setWorkoutDate(e.target.value)} className="w-full bg-neutral-900 border border-red-900/30 rounded-xl px-4 py-2 text-red-400 font-bold focus:outline-none focus:border-red-600" />

                <Card>
                  <h2 className="text-xl font-black text-red-400 uppercase mb-4">{workouts[selectedWorkout].name} Day</h2>
                  <div className="space-y-4">
                    {workouts[selectedWorkout].exercises.map((ex, i) => {
                      const exData = getExerciseData(workoutDate, selectedWorkout, ex);
                      const history = getWorkoutHistory(selectedWorkout, ex);
                      return (
                        <div key={i} className="p-4 bg-black rounded-xl border border-red-900/20">
                          <div className="flex items-center gap-3 mb-3">
                            <span className="w-7 h-7 bg-red-600 text-white rounded-lg flex items-center justify-center text-sm font-black">{i + 1}</span>
                            <span className="font-bold text-white">{ex}</span>
                          </div>
                          <div className="grid grid-cols-3 gap-2 mb-2">
                            {['weight', 'sets', 'reps'].map(field => (
                              <div key={field}>
                                <label className="text-xs text-red-500 font-bold uppercase">{field}</label>
                                <input type="number" placeholder={field === 'weight' ? 'lbs' : '#'} value={exData[field]} onChange={(e) => updateExerciseLog(workoutDate, selectedWorkout, ex, field, e.target.value)} className="w-full bg-neutral-900 border border-red-900/30 rounded-lg px-3 py-2 text-red-400 font-bold text-sm focus:outline-none focus:border-red-600" />
                              </div>
                            ))}
                          </div>
                          {history.length > 0 && (
                            <div className="flex flex-wrap gap-1 mt-2">
                              {history.map((h, hi) => (
                                <span key={hi} className="text-xs bg-red-950/50 text-red-400 rounded-lg px-2 py-1">{h.date.slice(5)}: {h.weight}√ó{h.sets}√ó{h.reps}</span>
                              ))}
                            </div>
                          )}
                        </div>
                      );
                    })}
                  </div>
                </Card>

                {/* CARDIO COMMAND */}
                <Card className="border-cyan-900/30">
                  <h2 className="text-lg font-black text-cyan-400 uppercase tracking-wider mb-2">üèÉ CARDIO COMMAND</h2>
                  <p className="text-cyan-600 text-xs mb-4">GOAL: 1 HOUR DAILY (2√ó30 MIN)</p>
                  <div className="space-y-2">
                    <ReactorSwitch
                      engaged={todayData.cardio1}
                      onToggle={() => toggleMeal(today, 'cardio1')}
                      label="SESSION I: 30 MIN"
                      color="blue"
                    />
                    <ReactorSwitch
                      engaged={todayData.cardio2}
                      onToggle={() => toggleMeal(today, 'cardio2')}
                      label="SESSION II: 30 MIN"
                      color="blue"
                    />
                  </div>
                  <div className="mt-3 flex items-center gap-2">
                    <div className="flex-1 h-2 bg-neutral-900 rounded-full overflow-hidden">
                      <div className={`h-2 bg-gradient-to-r from-cyan-600 to-cyan-400 rounded-full transition-all`} style={{ width: `${((todayData.cardio1 ? 1 : 0) + (todayData.cardio2 ? 1 : 0)) * 50}%` }} />
                    </div>
                    <span className="text-cyan-400 text-xs font-bold">{(todayData.cardio1 ? 30 : 0) + (todayData.cardio2 ? 30 : 0)}/60 MIN</span>
                  </div>
                </Card>
              </div>
            )}

            {/* POWER LEVEL */}
            {currentView === 'power' && (
              <div className="space-y-4 animate-fade-in">
                <Card className="bg-gradient-to-br from-yellow-950/30 to-black border-yellow-700/30">
                  <h2 className="text-xl font-black text-yellow-400 uppercase tracking-wider flex items-center gap-2 mb-4">
                    üèÜ POWER LEVEL
                  </h2>
                  <p className="text-yellow-600 text-xs mb-4">YOUR PERSONAL RECORDS - PROOF OF STRENGTH</p>
                </Card>

                {Object.keys(prNames).map(lift => (
                  <Card key={lift} className="border-yellow-900/40">
                    <div className="flex items-center gap-2 mb-3">
                      <span className="text-xl">üèÜ</span>
                      <h3 className="font-black text-yellow-400 uppercase">{prNames[lift]}</h3>
                    </div>
                    {personalRecords[lift]?.weight && personalRecords[lift]?.reps ? (
                      <div className="bg-gradient-to-r from-yellow-950/50 to-transparent border-l-4 border-yellow-500 rounded-r-xl p-3 mb-3">
                        <p className="text-yellow-300 font-black text-lg">
                          {personalRecords[lift].weight} LBS √ó {personalRecords[lift].reps} REPS
                        </p>
                        {personalRecords[lift].date && (
                          <p className="text-yellow-600 text-xs mt-1">{personalRecords[lift].date}</p>
                        )}
                      </div>
                    ) : (
                      <p className="text-red-600 text-sm mb-3 italic">NO PR SET YET</p>
                    )}
                    <div className="grid grid-cols-3 gap-2">
                      <div>
                        <label className="text-xs text-yellow-600 font-bold">WEIGHT</label>
                        <input type="number" placeholder="LBS" value={personalRecords[lift]?.weight || ''} onChange={(e) => updatePR(lift, 'weight', e.target.value)} className="w-full bg-black border border-yellow-900/50 rounded-lg px-3 py-2 text-yellow-400 font-bold text-sm focus:outline-none focus:border-yellow-600" />
                      </div>
                      <div>
                        <label className="text-xs text-yellow-600 font-bold">REPS</label>
                        <input type="number" placeholder="#" value={personalRecords[lift]?.reps || ''} onChange={(e) => updatePR(lift, 'reps', e.target.value)} className="w-full bg-black border border-yellow-900/50 rounded-lg px-3 py-2 text-yellow-400 font-bold text-sm focus:outline-none focus:border-yellow-600" />
                      </div>
                      <div>
                        <label className="text-xs text-yellow-600 font-bold">DATE</label>
                        <input type="date" value={personalRecords[lift]?.date || ''} onChange={(e) => updatePR(lift, 'date', e.target.value)} className="w-full bg-black border border-yellow-900/50 rounded-lg px-3 py-2 text-yellow-400 font-bold text-sm focus:outline-none focus:border-yellow-600" />
                      </div>
                    </div>
                  </Card>
                ))}
              </div>
            )}

            {/* CALENDAR */}
            {currentView === 'calendar' && (
              <div className="space-y-4 animate-fade-in">
                <Card>
                  <div className="flex justify-between items-center mb-4">
                    <button onClick={() => setCalendarMonth(new Date(calendarMonth.getFullYear(), calendarMonth.getMonth() - 1))} className="text-red-500 font-bold text-xl px-3 py-1 hover:bg-red-950/30 rounded-lg transition-colors">‚Üê</button>
                    <h2 className="text-lg font-black text-red-400 uppercase tracking-wider">
                      {calendarMonth.toLocaleDateString('en-US', { month: 'long', year: 'numeric' })}
                    </h2>
                    <button onClick={() => setCalendarMonth(new Date(calendarMonth.getFullYear(), calendarMonth.getMonth() + 1))} className="text-red-500 font-bold text-xl px-3 py-1 hover:bg-red-950/30 rounded-lg transition-colors">‚Üí</button>
                  </div>

                  {/* Day headers */}
                  <div className="grid grid-cols-7 gap-1 mb-2">
                    {['S', 'M', 'T', 'W', 'T', 'F', 'S'].map((d, i) => (
                      <div key={i} className="text-center text-xs font-bold text-red-600">{d}</div>
                    ))}
                  </div>

                  {/* Calendar grid */}
                  <div className="grid grid-cols-7 gap-1">
                    {getCalendarDays().map((day, i) => {
                      const status = getDayStatus(day);
                      const statusColors = {
                        empty: 'bg-transparent',
                        future: 'bg-neutral-900 text-neutral-700',
                        perfect: 'bg-gradient-to-br from-yellow-600 to-yellow-500 text-black',
                        partial: 'bg-gradient-to-br from-red-700 to-red-600 text-white',
                        missed: 'bg-neutral-950 text-neutral-600 border border-neutral-800'
                      };
                      return (
                        <div
                          key={i}
                          className={`aspect-square flex items-center justify-center rounded-lg text-xs font-bold cursor-pointer active:scale-95 transition-transform ${statusColors[status]}`}
                          onTouchStart={() => {
                            if (day && status !== 'future') {
                              const timer = setTimeout(() => setCalendarDayDetail(day), 500);
                              setLongPressTimer(timer);
                            }
                          }}
                          onTouchEnd={() => { if (longPressTimer) clearTimeout(longPressTimer); }}
                          onMouseDown={() => {
                            if (day && status !== 'future') {
                              const timer = setTimeout(() => setCalendarDayDetail(day), 500);
                              setLongPressTimer(timer);
                            }
                          }}
                          onMouseUp={() => { if (longPressTimer) clearTimeout(longPressTimer); }}
                          onMouseLeave={() => { if (longPressTimer) clearTimeout(longPressTimer); }}
                        >
                          {day}
                        </div>
                      );
                    })}
                  </div>

                  {/* Day Detail Modal */}
                  {calendarDayDetail && (
                    <div className="fixed inset-0 bg-black/90 flex items-center justify-center z-50 p-4" onClick={() => setCalendarDayDetail(null)}>
                      <div className="bg-neutral-900 rounded-2xl p-6 max-w-sm w-full border border-red-900/30" onClick={e => e.stopPropagation()}>
                        <div className="flex justify-between items-center mb-4">
                          <h3 className="text-lg font-black text-red-400">
                            {calendarMonth.toLocaleDateString('en-US', { month: 'short' })} {calendarDayDetail}
                          </h3>
                          <button onClick={() => setCalendarDayDetail(null)} className="text-neutral-500 hover:text-white text-xl">√ó</button>
                        </div>
                        {(() => {
                          const dayNames = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
                          const dateObj = new Date(calendarMonth.getFullYear(), calendarMonth.getMonth(), calendarDayDetail);
                          const dayName = dayNames[dateObj.getDay()];
                          const data = weekData[dayName] || {};
                          return (
                            <div className="space-y-3">
                              <div className="flex justify-between items-center">
                                <span className="text-neutral-400 text-sm">Weight</span>
                                <span className="text-white font-bold">{data.weight || '‚Äî'} LBS</span>
                              </div>
                              <div className="flex justify-between items-center">
                                <span className="text-neutral-400 text-sm">Meals</span>
                                <div className="flex gap-1">
                                  {['meal1', 'meal2', 'meal3'].map((m, idx) => (
                                    <div key={m} className={`w-6 h-6 rounded flex items-center justify-center text-xs font-bold ${data[m] ? 'bg-red-600 text-white' : 'bg-neutral-800 text-neutral-600'}`}>
                                      {data[m] ? '‚úì' : idx + 1}
                                    </div>
                                  ))}
                                </div>
                              </div>
                              <div className="flex justify-between items-center">
                                <span className="text-neutral-400 text-sm">Training</span>
                                <span className={`font-bold ${data.training ? 'text-green-400' : 'text-neutral-600'}`}>{data.training ? 'COMPLETE' : 'SKIPPED'}</span>
                              </div>
                              <div className="flex justify-between items-center">
                                <span className="text-neutral-400 text-sm">Water</span>
                                <span className="text-blue-400 font-bold">{data.water || 0}/8 glasses</span>
                              </div>
                            </div>
                          );
                        })()}
                      </div>
                    </div>
                  )}
                </Card>

                {/* Legend */}
                <Card>
                  <h3 className="text-sm font-bold text-red-500 uppercase tracking-wider mb-3">LEGEND</h3>
                  <div className="grid grid-cols-2 gap-2">
                    <div className="flex items-center gap-2">
                      <div className="w-4 h-4 rounded bg-gradient-to-br from-yellow-600 to-yellow-500"></div>
                      <span className="text-xs text-yellow-400 font-bold">PERFECT DAY</span>
                    </div>
                    <div className="flex items-center gap-2">
                      <div className="w-4 h-4 rounded bg-gradient-to-br from-red-700 to-red-600"></div>
                      <span className="text-xs text-red-400 font-bold">PARTIAL</span>
                    </div>
                    <div className="flex items-center gap-2">
                      <div className="w-4 h-4 rounded bg-neutral-950 border border-neutral-800"></div>
                      <span className="text-xs text-neutral-500 font-bold">MISSED</span>
                    </div>
                    <div className="flex items-center gap-2">
                      <div className="w-4 h-4 rounded bg-neutral-900"></div>
                      <span className="text-xs text-neutral-600 font-bold">FUTURE</span>
                    </div>
                  </div>
                </Card>
              </div>
            )}

            {/* GROCERY */}
            {currentView === 'grocery' && (
              <div className="space-y-4 animate-fade-in">
                <Card>
                  <h2 className="font-black text-orange-400 uppercase mb-3">BULK STAPLES</h2>
                  <div className="space-y-2">
                    {groceryBulk.map(it => (
                      <button key={it} onClick={() => toggleGrocery(it)} className={`w-full flex items-center gap-3 p-3 rounded-xl transition-all duration-300 ${groceryChecked[it] ? 'bg-green-950/30 border border-green-700/30' : 'bg-black border border-orange-900/20'}`}>
                        <div className={`w-6 h-6 rounded-lg flex items-center justify-center font-bold transition-colors ${groceryChecked[it] ? 'bg-green-600 text-white' : 'bg-neutral-900 border border-orange-900/30'}`}>
                          {groceryChecked[it] && '‚úì'}
                        </div>
                        <span className={`text-sm font-bold transition-all ${groceryChecked[it] ? 'text-green-400/70 line-through' : 'text-orange-300'}`}>{it}</span>
                      </button>
                    ))}
                  </div>
                </Card>

                <Card>
                  <h2 className="font-black text-red-400 uppercase mb-3">WEEKLY FRESH</h2>
                  <div className="space-y-2">
                    {groceryWeekly.map(it => (
                      <button key={it} onClick={() => toggleGrocery(it)} className={`w-full flex items-center gap-3 p-3 rounded-xl transition-all duration-300 ${groceryChecked[it] ? 'bg-green-950/30 border border-green-700/30' : 'bg-black border border-red-900/20'}`}>
                        <div className={`w-6 h-6 rounded-lg flex items-center justify-center font-bold transition-colors ${groceryChecked[it] ? 'bg-green-600 text-white' : 'bg-neutral-900 border border-red-900/30'}`}>
                          {groceryChecked[it] && '‚úì'}
                        </div>
                        <span className={`text-sm font-bold transition-all ${groceryChecked[it] ? 'text-green-400/70 line-through' : 'text-red-300'}`}>{it}</span>
                      </button>
                    ))}
                  </div>
                </Card>
              </div>
            )}

          </div>

          {/* Logged Confirmation Popup */}
          {showLogged && (
            <div className="fixed inset-0 flex items-center justify-center pointer-events-none z-50">
              <div className="text-4xl font-black text-green-400" style={{animation: 'yumPop 1.5s ease-out forwards'}}>LOGGED! ‚úì</div>
            </div>
          )}

        </div>
      );
    };

    ReactDOM.render(<AhabApp />, document.getElementById('root'));
  </script>
</body>
</html>
