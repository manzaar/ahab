<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ahab - Your Fitness Journey</title>
  <style>
    @keyframes yumPop {
      0% { opacity: 0; transform: scale(0.5); }
      20% { opacity: 1; transform: scale(1.1); }
      40% { transform: scale(1); }
      100% { opacity: 0; transform: scale(1.2) translateY(-30px); }
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }
    .animate-fade-in { animation: fadeIn 0.5s ease-out forwards; }
    .glass { background: rgba(255,255,255,0.03); backdrop-filter: blur(10px); }
  </style>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            dark: { 50: '#f8fafc', 100: '#1e293b', 200: '#1a2332', 300: '#151c28', 400: '#0f1419', 500: '#0a0e13' },
            accent: { light: '#6ee7b7', DEFAULT: '#10b981', dark: '#059669' }
          }
        }
      }
    }
  </script>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">
    const { useState, useEffect } = React;

    const AhabApp = () => {
      const [currentView, setCurrentView] = useState('home');
      const [weekData, setWeekData] = useState({});
      const [currentWeight, setCurrentWeight] = useState('233');
      const [groceryChecked, setGroceryChecked] = useState({});
      const [workoutLog, setWorkoutLog] = useState({});
      const [selectedWorkout, setSelectedWorkout] = useState('push');
      const [quoteIndex, setQuoteIndex] = useState(0);
      const [quoteFade, setQuoteFade] = useState(true);
      const [workoutDate, setWorkoutDate] = useState(new Date().toISOString().split('T')[0]);
      const [videos, setVideos] = useState([]);
      const [newVideoUrl, setNewVideoUrl] = useState('');
      const [activeVideo, setActiveVideo] = useState(null);
      const [videoCategory, setVideoCategory] = useState('all');
      const [timerSeconds, setTimerSeconds] = useState(90);
      const [timerRunning, setTimerRunning] = useState(false);
      const [timerMode, setTimerMode] = useState('rest');
      const [showYum, setShowYum] = useState(false);

      const defaultVideos = [
        { id: 'eC7xzavzEKY', title: 'Why Life Seems to Speed Up as We Age', category: 'philosophy' },
        { id: 'WPPPFqsECz0', title: 'The philosophy of Stoicism', category: 'philosophy' },
        { id: 'w8-k_EJW5bY', title: 'Why Socrates Hated Democracy', category: 'philosophy' },
        { id: '5sD_2jNl5b4', title: 'The Absurd Philosophy of Albert Camus', category: 'philosophy' },
        { id: 'D7CH9cRN8Rg', title: 'What Is Existentialism?', category: 'philosophy' },
        { id: 'rE3j_RHkqJc', title: 'The Psychology of Self-Deception', category: 'psychology' },
        { id: 'wfYbgdo8e-8', title: 'Carl Jung - How to Realize Your True Potential', category: 'psychology' },
        { id: 'n3Xv_g3g-mA', title: 'Dopamine Detox: Why You Should Do It', category: 'psychology' },
        { id: 'LO1mTELoj6o', title: 'Why You Procrastinate Even When It Feels Bad', category: 'psychology' },
        { id: 'EbBHk_zLTmY', title: 'History of the Entire World', category: 'history' },
        { id: 'xuCn8ux2gbs', title: 'History of Japan', category: 'history' },
        { id: '9BugznGj6bU', title: 'The Fall of Rome Explained', category: 'history' },
        { id: 'EY6q5dv_B-o', title: 'Genghis Khan - Rise of the Mongol Empire', category: 'history' },
      ];

      const triggerYum = () => { setShowYum(true); setTimeout(() => setShowYum(false), 1000); };

      const days = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'];

      const quotes = [
        { quote: "The only way to do great work is to love what you do.", char: "Steve Jobs" },
        { quote: "Success is not final, failure is not fatal.", char: "Winston Churchill" },
        { quote: "The body achieves what the mind believes.", char: "Napoleon Hill" },
        { quote: "Push through the pain. Giving up hurts more.", char: "Anonymous" },
        { quote: "Strength does not come from physical capacity. It comes from an indomitable will.", char: "Gandhi" },
        { quote: "A lesson without pain is meaningless.", char: "Edward Elric" },
        { quote: "The only person you are destined to become is the person you decide to be.", char: "Emerson" },
        { quote: "Believe in the me that believes in you!", char: "Kamina" },
        { quote: "Your body can stand almost anything. It's your mind you have to convince.", char: "Unknown" },
        { quote: "A dropout will beat a genius through hard work.", char: "Rock Lee" },
        { quote: "Surpass your limits. Right here, right now.", char: "Yami Sukehiro" },
        { quote: "The world isn't perfect. But it's there for us, doing the best it can.", char: "Roy Mustang" },
      ];

      const currentQuote = quotes[quoteIndex];

      const getTodayString = () => {
        const dayNames = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
        return dayNames[new Date().getDay()];
      };

      useEffect(() => {
        const cycleQuotes = setInterval(() => {
          setQuoteFade(false);
          setTimeout(() => { setQuoteIndex(prev => (prev + 1) % quotes.length); setQuoteFade(true); }, 500);
        }, 6000);
        return () => clearInterval(cycleQuotes);
      }, []);

      const meals = [
        { id: 'meal1', name: 'Breakfast', calories: 700, items: ['4 whole eggs', '200g oatmeal', '1 banana', '100g berries'], macros: '42g protein · 70g carbs · 28g fat' },
        { id: 'meal2', name: 'Lunch', calories: 700, items: ['200g chicken breast', '200g rice', '150g broccoli', '1 tbsp olive oil'], macros: '62g protein · 55g carbs · 16g fat' },
        { id: 'meal3', name: 'Dinner', calories: 700, items: ['200g beef', '300g sweet potato', '200g vegetables', '200g yogurt'], macros: '96g protein · 55g carbs · 16g fat' }
      ];

      const groceryBulk = ['Oats (large container)', 'Rice (5-10 lb bag)', 'Sweet potatoes (10 lb)', 'Olive oil', 'Seasonings & spices'];
      const groceryWeekly = ['Eggs (2 dozen)', 'Chicken breast (3 lbs)', 'Beef (3 lbs)', 'Bananas (7-8)', 'Mixed berries (700g)', 'Broccoli (2 lbs)', 'Mixed vegetables (3 lbs)', 'Greek yogurt (1400g)'];

      const workouts = {
        push: { name: 'Push', exercises: ['Bench Press', 'Overhead Press', 'Incline Dumbbell Press', 'Lateral Raises', 'Tricep Pushdowns'] },
        pull: { name: 'Pull', exercises: ['Pull-ups', 'Barbell Rows', 'Face Pulls', 'Bicep Curls', 'Lat Pulldowns'] },
        legs: { name: 'Legs', exercises: ['Squats', 'Romanian Deadlifts', 'Leg Press', 'Leg Curls', 'Calf Raises'] }
      };

      useEffect(() => {
        const saved = localStorage.getItem('weekData');
        if (saved) setWeekData(JSON.parse(saved));
        else {
          const init = {};
          days.forEach(d => { init[d] = { meal1: false, meal2: false, meal3: false, training: false, weight: '', water: 0 }; });
          setWeekData(init);
        }
        const w = localStorage.getItem('currentWeight'); if (w) setCurrentWeight(w);
        const g = localStorage.getItem('grocery'); if (g) setGroceryChecked(JSON.parse(g));
        const wl = localStorage.getItem('workouts'); if (wl) setWorkoutLog(JSON.parse(wl));
        const vids = localStorage.getItem('videos');
        if (vids) { const saved = JSON.parse(vids); const merged = [...defaultVideos]; saved.forEach(v => { if (!merged.find(m => m.id === v.id)) merged.push(v); }); setVideos(merged); }
        else setVideos(defaultVideos);
      }, []);

      const toggleMeal = (day, meal) => {
        const newData = { ...weekData, [day]: { ...weekData[day], [meal]: !weekData[day][meal] } };
        setWeekData(newData); localStorage.setItem('weekData', JSON.stringify(newData));
      };

      const updateWeight = (day, wt) => {
        const newData = { ...weekData, [day]: { ...weekData[day], weight: wt } };
        setWeekData(newData); localStorage.setItem('weekData', JSON.stringify(newData));
        if (wt) { setCurrentWeight(wt); localStorage.setItem('currentWeight', wt); }
      };

      const updateWater = (day, amt) => {
        const newData = { ...weekData, [day]: { ...weekData[day], water: amt } };
        setWeekData(newData); localStorage.setItem('weekData', JSON.stringify(newData));
      };

      const toggleGrocery = (item) => {
        const newChecked = { ...groceryChecked, [item]: !groceryChecked[item] };
        setGroceryChecked(newChecked); localStorage.setItem('grocery', JSON.stringify(newChecked));
      };

      const updateExerciseLog = (date, workoutType, exercise, field, value) => {
        const newLog = { ...workoutLog };
        if (!newLog[date]) newLog[date] = {};
        if (!newLog[date][workoutType]) newLog[date][workoutType] = {};
        if (!newLog[date][workoutType][exercise]) newLog[date][workoutType][exercise] = { weight: '', reps: '', sets: '' };
        newLog[date][workoutType][exercise][field] = value;
        setWorkoutLog(newLog); localStorage.setItem('workouts', JSON.stringify(newLog));
      };

      const getExerciseData = (date, workoutType, exercise) => workoutLog[date]?.[workoutType]?.[exercise] || { weight: '', reps: '', sets: '' };

      const getWorkoutHistory = (workoutType, exercise) => {
        const history = [];
        Object.keys(workoutLog).sort().reverse().forEach(date => {
          if (workoutLog[date]?.[workoutType]?.[exercise]) {
            const data = workoutLog[date][workoutType][exercise];
            if (data.weight || data.reps || data.sets) history.push({ date, ...data });
          }
        });
        return history.slice(0, 5);
      };

      const filteredVideos = videoCategory === 'all' ? videos : videos.filter(v => v.category === videoCategory);

      useEffect(() => {
        let interval;
        if (timerRunning && timerSeconds > 0) interval = setInterval(() => setTimerSeconds(s => s - 1), 1000);
        else if (timerSeconds === 0) { setTimerRunning(false); try { new Audio('data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdH2Onp+dnZygo6esnZGJgoiTpLrK0M/GurCsq7C5x9PZ2NDCsJ+Uk5Wgr8HS3+DYyru0tbvG1eHo5t3OvrCpqKyzvczc5Obi2My/tK+usMHR4Ojp4dXJvrSur7fE1eDn6OHWyL2zrrC4x9Xg5+fi2cvAtrGxtMDS3+fp5drNwba0trnH1uDo6eTdz8O5tbW4wtTg6Orl4dPIvrm3usPV4ejr5+LWzMK8urrD1+Hq7ejk2tDGwLy8wcnZ4+vs6OXc08nDwL/Ey9rk7O3p5t3Vy8fExMjO2+Tu7uro4NjQy8jHyc/d5e7v7Orn4drTzsvKzNTf5+/w7uvn4t3X0s/O0Nfh6fDx7+3q5uHc2NTS0dPa4+vy8vDu6+fj39vX1dTW3OTq8vPx7+zp5ODb19XV1tvi6fHz8vDt6ubj39zY1tbY3+Xr8/Ty8O3q5+Tf3NnY19rf5Ovz9PPx7uro5ODd2tnZ2t/l6/P09PH').play(); } catch(e) {} }
        return () => clearInterval(interval);
      }, [timerRunning, timerSeconds]);

      const formatTime = (secs) => `${Math.floor(secs / 60)}:${(secs % 60).toString().padStart(2, '0')}`;
      const timerPresets = { rest: [30, 60, 90, 120, 180], hiit: [20, 30, 45, 60] };

      const getTimeGreeting = () => {
        const hour = new Date().getHours();
        if (hour < 12) return 'Good morning';
        if (hour < 17) return 'Good afternoon';
        if (hour < 21) return 'Good evening';
        return 'Late night grind';
      };

      const getWeeklyStats = () => {
        let mealsHit = 0, totalMeals = 0, workoutsHit = 0, waterTotal = 0;
        days.forEach(d => {
          if (weekData[d]) {
            if (weekData[d].meal1) mealsHit++; if (weekData[d].meal2) mealsHit++; if (weekData[d].meal3) mealsHit++;
            totalMeals += 3; if (weekData[d].training) workoutsHit++; waterTotal += weekData[d].water || 0;
          }
        });
        return { mealsHit, workoutsHit, consistency: totalMeals > 0 ? Math.round((mealsHit / totalMeals) * 100) : 0, waterTotal };
      };

      const getStreak = () => {
        let streak = 0;
        const dayOrder = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
        const todayIdx = new Date().getDay();
        for (let i = 0; i <= todayIdx; i++) {
          const d = dayOrder[i];
          if (weekData[d] && (weekData[d].meal1 || weekData[d].meal2 || weekData[d].meal3 || weekData[d].training)) streak++;
        }
        return streak;
      };

      const getNextWorkout = () => {
        const rotation = ['push', 'pull', 'legs'];
        const lastWorkouts = [];
        Object.keys(workoutLog).sort().reverse().slice(0, 3).forEach(date => {
          Object.keys(workoutLog[date] || {}).forEach(wType => { if (!lastWorkouts.includes(wType)) lastWorkouts.push(wType); });
        });
        if (lastWorkouts.length === 0) return 'push';
        const lastIdx = rotation.indexOf(lastWorkouts[0]);
        return rotation[(lastIdx + 1) % 3];
      };

      const getYouTubeId = (url) => { const match = url.match(/(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))([^&?]+)/); return match ? match[1] : null; };
      const addVideo = () => {
        const videoId = getYouTubeId(newVideoUrl);
        if (videoId && !videos.find(v => v.id === videoId)) {
          const newVideos = [...videos, { id: videoId, title: 'Custom Video', category: 'custom' }];
          setVideos(newVideos); localStorage.setItem('videos', JSON.stringify(newVideos)); setNewVideoUrl('');
        }
      };
      const removeVideo = (videoId) => { const newVideos = videos.filter(v => v.id !== videoId); setVideos(newVideos); localStorage.setItem('videos', JSON.stringify(newVideos)); if (activeVideo === videoId) setActiveVideo(null); };

      const today = getTodayString();
      const todayData = weekData[today] || {};
      const progress = ((233 - parseFloat(currentWeight)) / 43) * 100;
      const weeklyStats = getWeeklyStats();
      const streak = getStreak();
      const nextWorkout = getNextWorkout();
      const lbsLost = Math.max(0, 233 - parseFloat(currentWeight || 233)).toFixed(1);

      const Card = ({ children, className = '', onClick }) => (
        <div onClick={onClick} className={`bg-slate-800/50 backdrop-blur-sm rounded-2xl p-5 border border-slate-700/50 transition-all duration-300 ${onClick ? 'cursor-pointer hover:bg-slate-800/70 hover:border-slate-600/50' : ''} ${className}`}>
          {children}
        </div>
      );

      const Button = ({ children, active, color = 'emerald', onClick, className = '' }) => (
        <button onClick={onClick} className={`px-4 py-2 rounded-xl font-medium transition-all duration-300 ${active ? `bg-${color}-500/20 text-${color}-400 border border-${color}-500/30` : 'bg-slate-800/50 text-slate-400 border border-slate-700/50 hover:bg-slate-700/50'} ${className}`}>
          {children}
        </button>
      );

      return (
        <div className="min-h-screen bg-gradient-to-br from-slate-900 via-slate-900 to-slate-800 text-white p-4 pb-24">
          <div className="max-w-lg mx-auto">
            {/* Header */}
            <div className="mb-6 text-center">
              <h1 className="text-2xl font-light tracking-widest text-slate-300 mb-1">AHAB</h1>
              <div className="flex items-center justify-center gap-2 text-emerald-400">
                <span className="text-lg font-semibold">{currentWeight}</span>
                <span className="text-slate-500">→</span>
                <span className="text-lg font-semibold">190 lbs</span>
              </div>
            </div>

            {/* Progress Bar */}
            <Card className="mb-6">
              <div className="flex justify-between text-sm mb-2">
                <span className="text-slate-400">Progress</span>
                <span className="text-emerald-400 font-medium">{progress.toFixed(1)}%</span>
              </div>
              <div className="w-full bg-slate-700/50 rounded-full h-2">
                <div className="bg-gradient-to-r from-emerald-500 to-teal-400 h-2 rounded-full transition-all duration-500" style={{ width: `${Math.min(progress, 100)}%` }} />
              </div>
            </Card>

            {/* Quote */}
            <div className={`mb-6 transition-opacity duration-500 ${quoteFade ? 'opacity-100' : 'opacity-0'}`}>
              <p className="text-slate-400 text-sm italic text-center">"{currentQuote.quote}"</p>
              <p className="text-slate-500 text-xs text-center mt-1">— {currentQuote.char}</p>
            </div>

            {/* Navigation */}
            <div className="flex gap-2 mb-6 overflow-x-auto pb-2 scrollbar-hide">
              {['home', 'meals', 'workouts', 'timer', 'grocery', 'watch'].map(v => (
                <button key={v} onClick={() => setCurrentView(v)} className={`px-4 py-2 rounded-xl text-sm font-medium whitespace-nowrap transition-all duration-300 ${currentView === v ? 'bg-emerald-500/20 text-emerald-400 border border-emerald-500/30' : 'bg-slate-800/50 text-slate-400 border border-slate-700/50 hover:bg-slate-700/50'}`}>
                  {v.charAt(0).toUpperCase() + v.slice(1)}
                </button>
              ))}
            </div>

            {/* HOME */}
            {currentView === 'home' && (
              <div className="space-y-4 animate-fade-in">
                <Card className="bg-gradient-to-br from-emerald-500/10 to-teal-500/5 border-emerald-500/20">
                  <div className="flex justify-between items-start">
                    <div>
                      <p className="text-slate-400 text-sm">{getTimeGreeting()}</p>
                      <h2 className="text-xl font-semibold text-white">Ready to conquer?</h2>
                    </div>
                    <div className="text-right">
                      <div className="text-3xl font-bold text-orange-400">{streak}</div>
                      <p className="text-xs text-slate-500">day streak</p>
                    </div>
                  </div>
                </Card>

                <div className="grid grid-cols-2 gap-3">
                  <Card>
                    <p className="text-2xl font-bold text-emerald-400">{lbsLost}</p>
                    <p className="text-xs text-slate-500">lbs lost</p>
                  </Card>
                  <Card>
                    <p className="text-2xl font-bold text-emerald-400">{weeklyStats.workoutsHit}/7</p>
                    <p className="text-xs text-slate-500">workouts</p>
                  </Card>
                  <Card>
                    <p className="text-2xl font-bold text-emerald-400">{weeklyStats.consistency}%</p>
                    <p className="text-xs text-slate-500">meal consistency</p>
                  </Card>
                  <Card>
                    <p className="text-2xl font-bold text-sky-400">{weeklyStats.waterTotal}</p>
                    <p className="text-xs text-slate-500">glasses water</p>
                  </Card>
                </div>

                <Card onClick={() => { setSelectedWorkout(nextWorkout); setCurrentView('workouts'); }} className="bg-gradient-to-r from-orange-500/10 to-amber-500/5 border-orange-500/20">
                  <div className="flex justify-between items-center">
                    <div>
                      <p className="text-xs text-slate-500 uppercase tracking-wide">Next workout</p>
                      <p className="text-lg font-semibold text-orange-400">{workouts[nextWorkout].name} Day</p>
                    </div>
                    <span className="text-slate-500 text-xl">→</span>
                  </div>
                </Card>

                <Card>
                  <h3 className="text-sm font-medium text-slate-400 mb-4">{today}'s Log</h3>
                  <div className="flex items-center gap-3 mb-4">
                    <span className="text-slate-500 text-sm w-16">Weight</span>
                    <input type="number" placeholder="lbs" value={todayData.weight || ''} onChange={(e) => updateWeight(today, e.target.value)} className="flex-1 bg-slate-700/50 border border-slate-600/50 rounded-xl px-4 py-2 text-white placeholder-slate-500 focus:outline-none focus:border-emerald-500/50 transition-colors" />
                  </div>
                  <div className="mb-4">
                    <span className="text-slate-500 text-sm block mb-2">Water intake</span>
                    <div className="flex gap-1">
                      {[1,2,3,4,5,6,7,8].map(n => (
                        <button key={n} onClick={() => updateWater(today, todayData.water === n ? 0 : n)} className={`flex-1 h-10 rounded-xl text-sm font-medium transition-all duration-300 ${(todayData.water || 0) >= n ? 'bg-sky-500/30 text-sky-400 border border-sky-500/30' : 'bg-slate-700/30 text-slate-600 border border-slate-700/30'}`}>{n}</button>
                      ))}
                    </div>
                  </div>
                  <div className="grid grid-cols-4 gap-2">
                    {['meal1', 'meal2', 'meal3'].map((m, i) => (
                      <button key={m} onClick={() => toggleMeal(today, m)} className={`py-3 rounded-xl text-sm font-medium transition-all duration-300 ${todayData[m] ? 'bg-emerald-500/20 text-emerald-400 border border-emerald-500/30' : 'bg-slate-700/30 text-slate-500 border border-slate-700/30'}`}>
                        M{i + 1}
                      </button>
                    ))}
                    <button onClick={() => toggleMeal(today, 'training')} className={`py-3 rounded-xl text-sm font-medium transition-all duration-300 ${todayData.training ? 'bg-orange-500/20 text-orange-400 border border-orange-500/30' : 'bg-slate-700/30 text-slate-500 border border-slate-700/30'}`}>
                      Gym
                    </button>
                  </div>
                </Card>

                <div className="flex justify-between px-2">
                  {[10, 25, 50, 75, 100].map(m => (
                    <div key={m} className="text-center">
                      <div className={`w-10 h-10 rounded-full flex items-center justify-center text-xs font-medium transition-all duration-300 ${progress >= m ? 'bg-emerald-500/20 text-emerald-400 border border-emerald-500/30' : 'bg-slate-800/50 text-slate-600 border border-slate-700/30'}`}>
                        {progress >= m ? '✓' : `${m}%`}
                      </div>
                    </div>
                  ))}
                </div>
              </div>
            )}

            {/* MEALS */}
            {currentView === 'meals' && (
              <div className="space-y-4 animate-fade-in relative">
                {showYum && (
                  <div className="fixed inset-0 flex items-center justify-center pointer-events-none z-50">
                    <div className="text-5xl font-bold text-emerald-400" style={{animation: 'yumPop 1s ease-out forwards'}}>Delicious!</div>
                  </div>
                )}

                <Card className="bg-gradient-to-r from-emerald-500/10 to-teal-500/5 border-emerald-500/20">
                  <div className="flex justify-between items-center">
                    <div>
                      <p className="text-xs text-slate-500 uppercase tracking-wide">Today's fuel</p>
                      <p className="text-2xl font-bold text-white">
                        {(todayData.meal1 ? 700 : 0) + (todayData.meal2 ? 700 : 0) + (todayData.meal3 ? 700 : 0)}
                        <span className="text-slate-500 text-lg font-normal"> / 2100 cal</span>
                      </p>
                    </div>
                    <div className="flex gap-1">
                      {['meal1', 'meal2', 'meal3'].map(m => (
                        <div key={m} className={`w-3 h-3 rounded-full transition-colors duration-300 ${todayData[m] ? 'bg-emerald-400' : 'bg-slate-700'}`}></div>
                      ))}
                    </div>
                  </div>
                </Card>

                {meals.map((m, idx) => (
                  <Card key={m.id} className={`transition-all duration-300 ${todayData[m.id] ? 'bg-emerald-500/5 border-emerald-500/20' : ''}`}>
                    <div className="flex justify-between items-start mb-3">
                      <div className="flex items-center gap-3">
                        <button onClick={() => { toggleMeal(today, m.id); if (!todayData[m.id]) triggerYum(); }} className={`w-7 h-7 rounded-lg flex items-center justify-center transition-all duration-300 ${todayData[m.id] ? 'bg-emerald-500 text-white' : 'bg-slate-700/50 border border-slate-600/50 text-slate-600'}`}>
                          {todayData[m.id] && '✓'}
                        </button>
                        <div>
                          <h3 className="font-semibold text-white">{m.name}</h3>
                          <p className="text-xs text-slate-500">{idx === 0 ? 'Morning fuel' : idx === 1 ? 'Midday power' : 'Evening recovery'}</p>
                        </div>
                      </div>
                      <span className="text-emerald-400 font-semibold">{m.calories} cal</span>
                    </div>
                    <ul className="space-y-1 mb-3">
                      {m.items.map((it, i) => <li key={i} className="text-slate-400 text-sm flex items-center gap-2"><span className="w-1 h-1 bg-slate-600 rounded-full"></span>{it}</li>)}
                    </ul>
                    <p className="text-xs text-slate-500">{m.macros}</p>
                  </Card>
                ))}

                <Card>
                  <p className="text-sm font-medium text-slate-400 mb-3">Daily totals</p>
                  <div className="grid grid-cols-3 gap-3">
                    <div className="text-center p-3 bg-slate-700/30 rounded-xl">
                      <p className="text-lg font-bold text-emerald-400">200g</p>
                      <p className="text-xs text-slate-500">Protein</p>
                    </div>
                    <div className="text-center p-3 bg-slate-700/30 rounded-xl">
                      <p className="text-lg font-bold text-amber-400">180g</p>
                      <p className="text-xs text-slate-500">Carbs</p>
                    </div>
                    <div className="text-center p-3 bg-slate-700/30 rounded-xl">
                      <p className="text-lg font-bold text-orange-400">60g</p>
                      <p className="text-xs text-slate-500">Fat</p>
                    </div>
                  </div>
                </Card>
              </div>
            )}

            {/* WORKOUTS */}
            {currentView === 'workouts' && (
              <div className="space-y-4 animate-fade-in">
                <div className="flex gap-2 mb-2">
                  {Object.keys(workouts).map(w => (
                    <button key={w} onClick={() => setSelectedWorkout(w)} className={`flex-1 py-2 rounded-xl text-sm font-medium transition-all duration-300 ${selectedWorkout === w ? 'bg-emerald-500/20 text-emerald-400 border border-emerald-500/30' : 'bg-slate-800/50 text-slate-400 border border-slate-700/50'}`}>{workouts[w].name}</button>
                  ))}
                </div>
                <input type="date" value={workoutDate} onChange={(e) => setWorkoutDate(e.target.value)} className="w-full bg-slate-800/50 border border-slate-700/50 rounded-xl px-4 py-2 text-slate-300 focus:outline-none focus:border-emerald-500/50" />

                <Card>
                  <h2 className="text-lg font-semibold text-white mb-4">{workouts[selectedWorkout].name} Day</h2>
                  <div className="space-y-4">
                    {workouts[selectedWorkout].exercises.map((ex, i) => {
                      const exData = getExerciseData(workoutDate, selectedWorkout, ex);
                      const history = getWorkoutHistory(selectedWorkout, ex);
                      return (
                        <div key={i} className="p-4 bg-slate-700/30 rounded-xl">
                          <div className="flex items-center gap-3 mb-3">
                            <span className="w-6 h-6 bg-emerald-500/20 text-emerald-400 rounded-lg flex items-center justify-center text-sm font-medium">{i + 1}</span>
                            <span className="font-medium text-white">{ex}</span>
                          </div>
                          <div className="grid grid-cols-3 gap-2 mb-2">
                            {['weight', 'sets', 'reps'].map(field => (
                              <div key={field}>
                                <label className="text-xs text-slate-500 uppercase tracking-wide">{field}</label>
                                <input type="number" placeholder={field === 'weight' ? 'lbs' : '#'} value={exData[field]} onChange={(e) => updateExerciseLog(workoutDate, selectedWorkout, ex, field, e.target.value)} className="w-full bg-slate-800/50 border border-slate-600/50 rounded-lg px-3 py-2 text-white text-sm focus:outline-none focus:border-emerald-500/50" />
                              </div>
                            ))}
                          </div>
                          {history.length > 0 && (
                            <div className="flex flex-wrap gap-1 mt-2">
                              {history.map((h, hi) => (
                                <span key={hi} className="text-xs bg-slate-800/50 text-slate-400 rounded-lg px-2 py-1">{h.date.slice(5)}: {h.weight}×{h.sets}×{h.reps}</span>
                              ))}
                            </div>
                          )}
                        </div>
                      );
                    })}
                  </div>
                </Card>
              </div>
            )}

            {/* TIMER */}
            {currentView === 'timer' && (
              <div className="space-y-4 animate-fade-in">
                <Card className="text-center py-8">
                  <div className={`text-6xl font-light mb-6 transition-colors duration-300 ${timerSeconds <= 10 && timerSeconds > 0 ? 'text-red-400' : 'text-white'}`} style={timerSeconds <= 10 && timerSeconds > 0 ? {animation: 'pulse 1s infinite'} : {}}>
                    {formatTime(timerSeconds)}
                  </div>
                  <div className="flex justify-center gap-3">
                    <button onClick={() => setTimerRunning(!timerRunning)} className={`px-8 py-3 rounded-xl font-medium transition-all duration-300 ${timerRunning ? 'bg-amber-500/20 text-amber-400 border border-amber-500/30' : 'bg-emerald-500/20 text-emerald-400 border border-emerald-500/30'}`}>
                      {timerRunning ? 'Pause' : 'Start'}
                    </button>
                    <button onClick={() => { setTimerRunning(false); setTimerSeconds(timerMode === 'rest' ? 90 : 30); }} className="px-6 py-3 bg-slate-800/50 text-slate-400 border border-slate-700/50 rounded-xl font-medium">
                      Reset
                    </button>
                  </div>
                </Card>

                <div className="flex gap-2">
                  <button onClick={() => { setTimerMode('rest'); setTimerSeconds(90); setTimerRunning(false); }} className={`flex-1 py-3 rounded-xl font-medium transition-all duration-300 ${timerMode === 'rest' ? 'bg-emerald-500/20 text-emerald-400 border border-emerald-500/30' : 'bg-slate-800/50 text-slate-400 border border-slate-700/50'}`}>
                    Rest Timer
                  </button>
                  <button onClick={() => { setTimerMode('hiit'); setTimerSeconds(30); setTimerRunning(false); }} className={`flex-1 py-3 rounded-xl font-medium transition-all duration-300 ${timerMode === 'hiit' ? 'bg-orange-500/20 text-orange-400 border border-orange-500/30' : 'bg-slate-800/50 text-slate-400 border border-slate-700/50'}`}>
                    HIIT
                  </button>
                </div>

                <Card>
                  <p className="text-sm text-slate-500 mb-3">Quick set</p>
                  <div className="flex flex-wrap gap-2">
                    {timerPresets[timerMode].map(secs => (
                      <button key={secs} onClick={() => { setTimerSeconds(secs); setTimerRunning(false); }} className={`px-4 py-2 rounded-xl text-sm font-medium transition-all duration-300 ${timerSeconds === secs && !timerRunning ? 'bg-emerald-500/20 text-emerald-400 border border-emerald-500/30' : 'bg-slate-700/30 text-slate-400 border border-slate-700/30'}`}>
                        {formatTime(secs)}
                      </button>
                    ))}
                  </div>
                </Card>
              </div>
            )}

            {/* GROCERY */}
            {currentView === 'grocery' && (
              <div className="space-y-4 animate-fade-in">
                <Card>
                  <h2 className="font-semibold text-amber-400 mb-3">Bulk Staples</h2>
                  <div className="space-y-2">
                    {groceryBulk.map(it => (
                      <button key={it} onClick={() => toggleGrocery(it)} className={`w-full flex items-center gap-3 p-3 rounded-xl transition-all duration-300 ${groceryChecked[it] ? 'bg-emerald-500/10 border border-emerald-500/20' : 'bg-slate-700/30 border border-slate-700/30'}`}>
                        <div className={`w-5 h-5 rounded-md flex items-center justify-center transition-colors ${groceryChecked[it] ? 'bg-emerald-500 text-white' : 'bg-slate-600/50'}`}>
                          {groceryChecked[it] && '✓'}
                        </div>
                        <span className={`text-sm transition-all ${groceryChecked[it] ? 'text-slate-500 line-through' : 'text-white'}`}>{it}</span>
                      </button>
                    ))}
                  </div>
                </Card>

                <Card>
                  <h2 className="font-semibold text-emerald-400 mb-3">Weekly Fresh</h2>
                  <div className="space-y-2">
                    {groceryWeekly.map(it => (
                      <button key={it} onClick={() => toggleGrocery(it)} className={`w-full flex items-center gap-3 p-3 rounded-xl transition-all duration-300 ${groceryChecked[it] ? 'bg-emerald-500/10 border border-emerald-500/20' : 'bg-slate-700/30 border border-slate-700/30'}`}>
                        <div className={`w-5 h-5 rounded-md flex items-center justify-center transition-colors ${groceryChecked[it] ? 'bg-emerald-500 text-white' : 'bg-slate-600/50'}`}>
                          {groceryChecked[it] && '✓'}
                        </div>
                        <span className={`text-sm transition-all ${groceryChecked[it] ? 'text-slate-500 line-through' : 'text-white'}`}>{it}</span>
                      </button>
                    ))}
                  </div>
                </Card>
              </div>
            )}

            {/* WATCH */}
            {currentView === 'watch' && (
              <div className="space-y-4 animate-fade-in">
                {activeVideo && (
                  <Card className="p-0 overflow-hidden">
                    <div className="flex justify-between items-center p-4 border-b border-slate-700/50">
                      <span className="font-medium text-white">Now Playing</span>
                      <button onClick={() => setActiveVideo(null)} className="text-slate-500 hover:text-white transition-colors">✕</button>
                    </div>
                    <div className="aspect-video">
                      <iframe className="w-full h-full" src={`https://www.youtube.com/embed/${activeVideo}?autoplay=1`} allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowFullScreen></iframe>
                    </div>
                  </Card>
                )}

                <div className="flex gap-2 overflow-x-auto pb-2">
                  {['all', 'philosophy', 'psychology', 'history', 'custom'].map(cat => (
                    <button key={cat} onClick={() => setVideoCategory(cat)} className={`px-3 py-1 rounded-lg text-sm font-medium whitespace-nowrap transition-all duration-300 ${videoCategory === cat ? 'bg-emerald-500/20 text-emerald-400' : 'bg-slate-800/50 text-slate-500'}`}>
                      {cat.charAt(0).toUpperCase() + cat.slice(1)}
                    </button>
                  ))}
                </div>

                <div className="grid grid-cols-2 gap-3">
                  {filteredVideos.map(v => (
                    <div key={v.id} onClick={() => setActiveVideo(v.id)} className={`relative group cursor-pointer rounded-xl overflow-hidden transition-all duration-300 ${activeVideo === v.id ? 'ring-2 ring-emerald-500' : ''}`}>
                      <img src={`https://img.youtube.com/vi/${v.id}/mqdefault.jpg`} alt="thumbnail" className="w-full aspect-video object-cover" />
                      <div className="absolute inset-0 bg-gradient-to-t from-black/80 via-transparent to-transparent"></div>
                      <div className="absolute bottom-0 left-0 right-0 p-2">
                        <p className="text-xs font-medium text-white line-clamp-2">{v.title}</p>
                        <span className="text-xs text-slate-400">{v.category}</span>
                      </div>
                      <div className="absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center">
                        <span className="text-3xl text-white">▶</span>
                      </div>
                      {v.category === 'custom' && (
                        <button onClick={(e) => { e.stopPropagation(); removeVideo(v.id); }} className="absolute top-2 right-2 w-6 h-6 bg-black/60 rounded-full text-white text-xs opacity-0 group-hover:opacity-100 transition-opacity">✕</button>
                      )}
                    </div>
                  ))}
                </div>

                <Card>
                  <p className="text-sm text-slate-500 mb-2">Add your own</p>
                  <div className="flex gap-2">
                    <input type="text" placeholder="Paste YouTube URL..." value={newVideoUrl} onChange={(e) => setNewVideoUrl(e.target.value)} onKeyDown={(e) => e.key === 'Enter' && addVideo()} className="flex-1 bg-slate-700/50 border border-slate-600/50 rounded-xl px-4 py-2 text-white text-sm placeholder-slate-500 focus:outline-none focus:border-emerald-500/50" />
                    <button onClick={addVideo} className="px-4 py-2 bg-emerald-500/20 text-emerald-400 border border-emerald-500/30 rounded-xl font-medium">Add</button>
                  </div>
                </Card>
              </div>
            )}

          </div>
        </div>
      );
    };

    ReactDOM.render(<AhabApp />, document.getElementById('root'));
  </script>
</body>
</html>
